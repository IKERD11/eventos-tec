<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Eventos - SGEA</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Flatpickr for Modern Date/Time inputs -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/themes/dark.css">

    <link rel="stylesheet" href="/src/style.css">
    <link rel="stylesheet" href="/src/dashboard.css">
    <link rel="stylesheet" href="/src/eventos.css">
</head>

<body class="app-body">
    <nav class="sidebar glass-panel">
        <div class="sidebar-header">
            <h2>SGEA</h2>
        </div>
        <ul class="nav-links">
            <li><a href="/dashboard.html">
                    <svg viewBox="0 0 24 24" fill="none" class="icon">
                        <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"></path>
                        <path stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M9 22V12h6v10"></path>
                    </svg> Dashboard
                </a></li>
            <li><a href="/calendario.html">
                    <svg viewBox="0 0 24 24" fill="none" class="icon" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="16" y1="2" x2="16" y2="6"></line>
                        <line x1="8" y1="2" x2="8" y2="6"></line>
                        <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg> Calendario
                </a></li>
            <li class="has-submenu-parent">
                <a href="#" class="active has-submenu" id="toggleSubmenuEventos">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <svg viewBox="0 0 24 24" fill="none" class="icon">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor"
                                stroke-width="2" stroke-linecap="round"></rect>
                            <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                d="M16 2v4M8 2v4M3 10h18"></path>
                        </svg> Eventos
                    </div>
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="submenu-arrow">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </a>
                <ul class="sidebar-submenu" id="submenuEventos">
                    <li><a href="#" class="sidebar-filter active" data-type="all" data-val="all">Todos los Eventos</a>
                    </li>
                    <li class="submenu-group">Tiempo</li>
                    <li><a href="#" class="sidebar-filter" data-type="tiempo" data-val="proximos">Pr칩ximos</a></li>
                    <li><a href="#" class="sidebar-filter" data-type="tiempo" data-val="pasados">Pasados</a></li>
                    <li class="submenu-group">Carreras</li>
                    <li><a href="#" class="sidebar-filter" data-type="clasificacion"
                            data-val="Ingenier칤a Industrial">Ingenier칤a Industrial</a></li>
                    <li><a href="#" class="sidebar-filter" data-type="clasificacion" data-val="ISC">Sistemas (ISC)</a>
                    </li>
                    <li><a href="#" class="sidebar-filter" data-type="clasificacion" data-val="IGE">Gesti칩n Empresarial
                            (IGE)</a></li>
                    <li><a href="#" class="sidebar-filter" data-type="clasificacion"
                            data-val="Ingenier칤a Mecatr칩nica">Mecatr칩nica</a></li>
                    <li><a href="#" class="sidebar-filter" data-type="clasificacion"
                            data-val="Ingenier칤a Electr칩nica">Electr칩nica</a></li>
                    <li><a href="#" class="sidebar-filter" data-type="clasificacion"
                            data-val="Ingenier칤a Civil">Civil</a></li>
                    <li><a href="#" class="sidebar-filter" data-type="clasificacion"
                            data-val="Contador P칰blico">Contador P칰blico</a></li>
                    <li><a href="#" class="sidebar-filter" data-type="clasificacion"
                            data-val="Institucional">Institucionales</a></li>
                </ul>
            </li>
            <li><a href="/participantes.html">
                    <svg viewBox="0 0 24 24" fill="none" class="icon">
                        <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"></path>
                        <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round">
                        </circle>
                        <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"></path>
                    </svg> Participantes
                </a></li>
            <li id="navAdmin" style="display:none;"><a href="/usuarios.html">
                    <svg viewBox="0 0 24 24" fill="none" class="icon" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg> Gestor Admin
                </a></li>
        </ul>
        <div class="sidebar-footer">
            <button id="logoutBtn" class="btn-logout">
                <svg viewBox="0 0 24 24" fill="none" class="icon">
                    <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"></path>
                </svg> Salir
            </button>
        </div>
    </nav>

    <div class="main-content">
        <header class="top-header glass-panel">
            <div class="page-title">
                <h1>Gesti칩n de Eventos</h1>
            </div>
            <div class="user-info" style="display: flex; gap: 15px; align-items: center;">
                <span id="userName">Cargando...</span>
                <button id="themeToggle" class="btn-icon">
                    <svg viewBox="0 0 24 24" fill="none" class="icon">
                        <path stroke="currentColor" stroke-width="2" stroke-linecap="round"
                            d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
                </button>
            </div>
        </header>

        <div class="page-body">
            <div class="action-bar glass-panel">
                <div class="left-actions"
                    style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap; flex: 1;">
                    <div class="search-box" style="flex: 1; min-width: 250px; max-width: 400px; margin: 0;">
                        <svg viewBox="0 0 24 24" fill="none" class="icon">
                            <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"></circle>
                            <path stroke="currentColor" stroke-width="2" stroke-linecap="round" d="M21 21l-4.35-4.35">
                            </path>
                        </svg>
                        <input type="text" id="searchEvento" placeholder="Buscar evento..." />
                    </div>

                    <div class="filters-container" style="display: flex; gap: 15px;">
                        <!-- Custom Select: Estado -->
                        <div class="custom-select" id="customSelectEstado" data-value="">
                            <div class="select-selected glass-select">
                                <span class="select-text">Todos los Estados</span>
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="select-items select-hide">
                                <div data-value="">Todos los Estados</div>
                                <div data-value="Activo">Activos</div>
                                <div data-value="Finalizado">Finalizados</div>
                                <div data-value="Cancelado">Cancelados</div>
                            </div>
                        </div>

                        <!-- Custom Select: Modalidad -->
                        <div class="custom-select" id="customSelectModalidad" data-value="">
                            <div class="select-selected glass-select">
                                <span class="select-text">Todas las Modalidades</span>
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="select-items select-hide">
                                <div data-value="">Todas las Modalidades</div>
                                <div data-value="Presencial">Presencial</div>
                                <div data-value="Virtual">Virtual</div>
                                <div data-value="H칤brido">H칤brido</div>
                            </div>
                        </div>
                    </div>
                </div>

                <button id="btnNuevoEvento" class="btn-primary" style="white-space: nowrap;">
                    <svg viewBox="0 0 24 24" fill="none" class="icon">
                        <line x1="12" y1="5" x2="12" y2="19" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round"></line>
                        <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round"></line>
                    </svg>
                    Nuevo Evento
                </button>
            </div>

            <!-- Grid de eventos -->
            <div class="eventos-grid" id="eventosGrid">
                <div class="loading-state">Cargando eventos...</div>
            </div>
        </div>
    </div>

    <!-- Modal Formulario -->
    <div id="eventoModal" class="modal-overlay">
        <div class="modal-content glass-form">
            <div class="modal-header">
                <h2 id="modalTitle">Crear Evento</h2>
                <button id="closeModal" class="btn-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor"
                        stroke-width="2" stroke-linecap="round">
                        <line x1="18" y1="6" x2="6" y2="18"></line>
                        <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg></button>
            </div>
            <form id="eventoForm">
                <input type="hidden" id="eventoId" />

                <div class="form-row">
                    <div class="input-group">
                        <label>T칤tulo del Evento *</label>
                        <input type="text" id="evTitulo" required />
                    </div>
                </div>

                <div class="form-row">
                    <div class="input-group full-width">
                        <label>Descripci칩n *</label>
                        <textarea id="evDescripcion" rows="3" required></textarea>
                    </div>
                </div>

                <div class="form-row double">
                    <div class="input-group">
                        <label>Modalidad *</label>
                        <input type="hidden" id="evModalidad" required value="Presencial" />
                        <div class="custom-select form-custom-select" id="customSelectFormModalidad"
                            data-value="Presencial">
                            <div class="select-selected">
                                <span class="select-text">Presencial</span>
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="select-items select-hide">
                                <div data-value="Presencial">Presencial</div>
                                <div data-value="Virtual">Virtual</div>
                                <div data-value="H칤brido">H칤brido</div>
                            </div>
                        </div>
                    </div>
                    <div class="input-group">
                        <label>Estado *</label>
                        <input type="hidden" id="evEstado" required value="Activo" />
                        <div class="custom-select form-custom-select" id="customSelectFormEstado" data-value="Activo">
                            <div class="select-selected">
                                <span class="select-text">Activo</span>
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="select-items select-hide">
                                <div data-value="Activo">Activo</div>
                                <div data-value="Finalizado">Finalizado</div>
                                <div data-value="Cancelado">Cancelado</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="input-group full-width">
                        <label>Clasificaci칩n / Carrera *</label>
                        <input type="hidden" id="evClasificacion" required value="Institucional" />
                        <div class="custom-select form-custom-select" id="customSelectFormClasificacion"
                            data-value="Institucional">
                            <div class="select-selected">
                                <span class="select-text">Institucional</span>
                                <svg viewBox="0 0 24 24" width="16" height="16" fill="none" stroke="currentColor"
                                    stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <polyline points="6 9 12 15 18 9"></polyline>
                                </svg>
                            </div>
                            <div class="select-items select-hide form-select-items">
                                <div data-value="Institucional">Institucional</div>
                                <div data-value="Ingenier칤a Industrial">Ingenier칤a Industrial</div>
                                <div data-value="ISC">Sistemas Computacionales (ISC)</div>
                                <div data-value="IGE">Gesti칩n Empresarial (IGE)</div>
                                <div data-value="Ingenier칤a Mecatr칩nica">Ingenier칤a Mecatr칩nica</div>
                                <div data-value="Ingenier칤a Electr칩nica">Ingenier칤a Electr칩nica</div>
                                <div data-value="Ingenier칤a Civil">Ingenier칤a Civil</div>
                                <div data-value="Contador P칰blico">Contador P칰blico</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-row double">
                    <div class="input-group">
                        <label>Fecha *</label>
                        <input type="date" id="evFecha" required />
                    </div>
                    <div class="input-group">
                        <label>Hora *</label>
                        <input type="time" id="evHora" required />
                    </div>
                </div>

                <div class="form-row double">
                    <div class="input-group">
                        <label>Lugar / Enlace</label>
                        <input type="text" id="evLugar" />
                    </div>
                    <div class="input-group">
                        <label>Cupo M치ximo *</label>
                        <input type="number" id="evCupo" min="1" required />
                    </div>
                </div>

                <div class="form-row">
                    <div class="input-group full-width">
                        <label>Im치genes del Evento (JPG/PNG)</label>
                        <div class="file-upload-wrapper">
                            <input type="file" id="evImagen" accept="image/jpeg, image/png" multiple />
                            <div class="file-upload-content">
                                <svg viewBox="0 0 24 24" fill="none" class="icon" stroke="currentColor" stroke-width="2"
                                    stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                    <polyline points="17 8 12 3 7 8"></polyline>
                                    <line x1="12" y1="3" x2="12" y2="15"></line>
                                </svg>
                                <span class="file-upload-text" id="fileNameDisplay">Arrastra im치genes o haz clic
                                    aqu칤</span>
                            </div>
                        </div>
                        <small class="file-hint">Puedes seleccionar m칰ltiples archivos. Deja vac칤o para conservar
                            im치genes actuales al editar.</small>
                    </div>
                </div>

                <p class="error-msg" id="modalError" style="display:none;"></p>

                <div class="modal-actions">
                    <button type="button" class="btn-secondary" id="btnCancel">Cancelar</button>
                    <button type="submit" class="btn-primary" id="btnSaveEvento">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Detalles del Evento (Read Only) -->
    <div id="detalleModal" class="modal-overlay">
        <div class="modal-content glass-form modal-detalle">
            <button id="closeDetalleModal" class="btn-icon close-floating"><svg viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round">
                    <line x1="18" y1="6" x2="6" y2="18"></line>
                    <line x1="6" y1="6" x2="18" y2="18"></line>
                </svg></button>

            <!-- Hero Image Header -->
            <div class="detalle-hero">
                <div class="detalle-main-img-container">
                    <img id="detImgPrincipal" src="" alt="Imagen principal del evento" style="display:none;" />
                    <button id="btnDownloadImg" class="btn-download-img" title="Descargar Imagen" style="display:none;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                            <polyline points="7 10 12 15 17 10"></polyline>
                            <line x1="12" y1="15" x2="12" y2="3"></line>
                        </svg>
                    </button>
                    <div id="detNoImg" class="no-img-placeholder">
                        <span>Sin Imagen</span>
                    </div>
                </div>
                <!-- Contenedor din치mico de miniaturas (Flotando o debajo) -->
                <div id="detMiniaturas" class="detalle-thumbnails"></div>
            </div>

            <!-- Body Content -->
            <div class="detalle-body">
                <div class="detalle-title-row">
                    <h2 id="detTitulo">T칤tulo del Evento</h2>
                    <div class="meta-chips">
                        <span id="detEstado" class="chip">Activo</span>
                        <span id="detModalidad" class="chip">Presencial</span>
                    </div>
                </div>

                <div class="info-strip">
                    <div class="info-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        <div>
                            <small>Fecha</small>
                            <strong id="detFecha">--</strong>
                        </div>
                    </div>
                    <div class="info-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        <div>
                            <small>Hora</small>
                            <strong id="detHora">--</strong>
                        </div>
                    </div>
                    <div class="info-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                            <circle cx="12" cy="10" r="3"></circle>
                        </svg>
                        <div>
                            <small>Lugar</small>
                            <strong id="detLugar">--</strong>
                        </div>
                    </div>
                    <div class="info-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        <div>
                            <small>Cupo</small>
                            <strong id="detCupo">--</strong>
                        </div>
                    </div>
                    <div class="info-item">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                        <div>
                            <small>Creador</small>
                            <strong id="detCreador">--</strong>
                        </div>
                    </div>
                </div>

                <div class="detalle-desc-block">
                    <p class="detalle-descripcion" id="detDescripcion"></p>
                </div>

                <div class="modal-actions-bottom">
                    <button type="button" class="btn-primary" id="btnDetalleParticipantes">
                        游논 Ver Participantes
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/es.js"></script>
    <script type="module" src="/src/eventos.js"></script>
</body>

</html>